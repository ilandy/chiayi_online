<section class="rpdetail main-wrap">
  <div class="main-content line-box" *ngIf="completeMessg === false">
    <div class="rpdetail-header">
      <header class="line-box-title deco-triangle">
        <h1>陳情案件</h1>

      </header>
      <form #myForm="ngForm" (change)="getBaseRequired(myForm)" >
        <div class="rpdetail-for">
          <div class="row">
            <div class="col-md-6">
              <div class="field">
                <label class="field-name">主項目</label>
                <input [ngModel]="caseType" name="item" class="field-entery" type="text" value="公園綠地行道樹維護" readonly>
              </div>
            </div>
            <div class="col-md-6">
              <div class="field">
                <label class="field-name">子項目</label>
                <input [ngModel]="subCaseType" name="subitem" class="field-entery" type="text" value="公園、綠地、安全島髒亂" readonly >
              </div>
            </div>

          </div>
        </div>

        <div class="rpdetail-fieldset pt-20">
            <div class="row">
              <div class="col-md-12" style="text-align: right">
                <strong class="font-color-brown"><span class="font-color-red">紅色</span>為必填。</strong>
              </div>
              <br>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <label for="name"><h4 class="form-title"><span class="font-color-red">*</span>姓名</h4></label>
              </div>
              <!-- 驗證姓名 -->
              <div class="col-md-9">
                <input #suggName="ngModel" ngModel name="Sugg_Name" type="text" id="name" placeholder="請輸入您的大名" required>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="valid form-common"><span class="font-color-red">*</span>陳情案件所在<span class="break-pc"></span>地區</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio row pt-20">
                  <li class="col-md-3 col-sm-2"><strong>嘉義市</strong></li>
                  <li class="col-md-3 col-sm-4" *ngFor="let dist of eventDists;let i = index" (click)="getSelectDist(i)">
                    <input [ngClass]="{'active':myForm.value.Subj_District == dist.DistrictId}" [ngModel]="eventDistDef" [value]="dist.DistrictId" name="Subj_District" type="radio" id="dist{{dist.DistrictId}}" >
                    <label for="dist{{dist.DistrictId}}" >{{dist.DistrictName}}</label>
                  </li>
                </ul>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="valid form-common"><span class="font-color-red">*</span>陳情案件所在<span class="break-pc"></span>里別</h4>
              </div>
              <div class="col-md-3">
                <div class="field">
                  <div class="field-select" role="combobox" (click)="eventSlider=!eventSlider">

                    <input class="field-entery" type="text" value="{{eventTownshipVal}}" readonly>
                    <select [(ngModel)]="eventTownshipDef" class="mb-select hidden-md hidden-lg" name="Subj_Zone" id="" (change)="getSelectText('eventTownshipVal',$event.target)">
                      <option *ngFor="let zone of eventSelectedDist.Zones" value="{{zone.ZoneCode}}">{{zone.ZoneName}}</option>
                    </select>

                  </div>
                </div>
              </div>
              <div class="col-md-6"></div>
              <div class="col-md-9 col-md-offset-2">
                 <div class="select" [ngClass]="{'active':eventSlider}">
                  <ul class="select-options hidden-sm hidden-xs">
                    <li *ngFor="let zone of eventSelectedDist.Zones" [ngClass]="{'active': eventTownshipDef === zone.ZoneCode }" (click)="getSliderItem('eventTownship',zone.ZoneName,zone.ZoneCode);">{{zone.ZoneName}}</li>
                  </ul>
                  <input type="hidden" [ngModel]="eventTownshipDef" name="Subj_Zone">
                </div>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <label for="addr"><h4 class="invalid"><span class="font-color-red">*</span>陳情案件所在<span class="break-pc"></span>地址</h4></label>
              </div>
              <div class="col-md-9">
                <!-- 驗證案發地址 -->
                <input #subLocation="ngModel" ngModel name="Subj_Location" type="text" id="addr" placeholder="請輸入地址" required>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <label for="gps1"><h4 class="invalid">陳情案件GPS<span class="break-pc"></span>定位</h4></label>
              </div>
              <div class="col-md-9">
                <!-- 驗證案發GPS -->
                <input #subLocation="ngModel" ngModel name="Subj_GPS" type="text" id="gps1" placeholder="緯度 23.481315" required>
                <input #subLocation="ngModel" ngModel name="Subj_GPS" type="text" id="gps2" placeholder="經度 120.4524993" required>
              </div>
            </div>


             <div class="row form-group">
              <div class="col-md-3">
                <label for="comment"><h4 class="form-title"><span class="font-color-red">*</span>案件內容</h4></label>
              </div>
              <div class="col-md-9">
                <!-- 驗證案發內容 -->
                <textarea #subContent="ngModel" ngModel name="Subj_Content" id="comment" placeholder="請輸案件內容" required></textarea>

              </div>
            </div>

            <div class="row form-group" *ngIf="showDangerOption">
              <div class="col-md-3 pb-20">
                <h4 class="my-0">是否有立即危險</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio row id-list">
                  <li class="col-md-3 col-sm-4">
                    <input [ngModel]="dangerDef" [ngClass]="{'active':myForm.value.Subj_IsinDanger =='N'}" name="Subj_IsinDanger" type="radio" value="N" id="danger01"> <label for="danger01">否</label>
                  </li>
                  <li class="col-md-3 col-sm-4">
                    <input [ngModel]="dangerDef" [ngClass]="{'active':myForm.value.Subj_IsinDanger == 'Y'}" name="Subj_IsinDanger" type="radio" value="Y" id="danger02"> <label for="danger02">是</label>
                  </li>
                </ul>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="form-title">回覆方式</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio pt-20">
                  <li class="col-md-4" *ngFor="let contact of contacts; let i = index">
                    <input [ngClass]="{'active':myForm.value.Sugg_ReplyWay == contact.Id}" [ngModel]="contactDef" name="Sugg_ReplyWay" type="radio" [value]="contact.Id" id="contact{{i}}"> <label class="checked" for="contact{{i}}">{{contact.Name}}</label>
                  </li>
                </ul>
              </div>

            </div>


            <div class="row form-group" *ngIf="myForm.value.Sugg_ReplyWay === '2'">
              <div class="col-md-3">
                <h4 class="valid form-common">陳情人回覆<span class="break-pc"></span>地址</h4>
              </div>
              <div class="col-md-9">
                <div class="row">
                  <div class="col-md-4">
                  <div class="field">
                    <div class="field-select" role="combobox" (click)="ctcCountrySlider = !ctcCountrySlider">
                      <input class="field-entery" type="text" value="{{ctcCountryVal}}" readonly>
                      <select [(ngModel)]="ctcCountryDef" class="mb-select hidden-md hidden-lg" name="Sugg_Addr1" (change)="getSelectText('ctcCountryVal',$event.target)">
                        <option *ngFor="let country of ctcCountrys" value="{{country.CountyCode}}">{{country.CountyName}}</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="field">
                    <div class="field-select" role="combobox" (click)="ctcDistSlider = !ctcDistSlider">
                      <input class="field-entery" type="text" value="{{ctcDistVal}}" readonly>
                      <select [(ngModel)]="ctcDistDef" class="mb-select hidden-md hidden-lg" name="Sugg_Addr2" id="" (change)="getSelectText('ctcDistVal',$event.target)">
                        <option *ngFor="let dist of ctcDists" value="{{dist.DistCode}}">{{dist.DistName}}</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="field">
                    <div class="field-select" role="combobox" (click)="ctcZoneSlider = !ctcZoneSlider">
                      <input class="field-entery" type="text" value="{{ctcZoneVal}}" readonly>
                      <select [(ngModel)]="ctcZoneDef" class="mb-select hidden-md hidden-lg" name="Sugg_Addr3" id="" (change)="getSelectText('ctcZoneVal',$event.target)">
                        <option *ngFor="let zone of ctcZones" value="{{zone.ZoneCode}}">{{zone.ZoneName}}</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="select" [ngClass]="{'active':ctcCountrySlider}">
                    <ul class="select-options hidden-xs hidden-sm">
                      <li *ngFor="let country of ctcCountrys" [ngClass]="{'active': ctcCountryDef === country.CountyCode }" (click)="getSliderItem('ctcCountry',country.CountyName,country.CountyCode);getCtcDist()">{{country.CountyName}}</li>
                    </ul>
                    <input type="hidden" [ngModel]="ctcCountryDef" name="Sugg_Addr1">

                  </div>
                  <div class="select" [ngClass]="{'active':ctcDistSlider}">
                    <ul class="select-options hidden-xs hidden-sm">
                      <li *ngFor="let dist of ctcDists" [ngClass]="{'active': ctcDistDef === dist.DistrictCode }" (click)="getSliderItem('ctcDist',dist.DistrictName,dist.DistrictCode);getCtcZone()" >{{dist.DistrictName}}</li>
                    </ul>
                    <input type="hidden" [ngModel]="ctcDistDef" name="Sugg_Addr2">

                  </div>
                  <div class="select" [ngClass]="{'active':ctcZoneSlider}">
                    <ul class="select-options hidden-xs hidden-sm">
                      <li *ngFor="let zone of ctcZones" [ngClass]="{'active': ctcZoneVal === zone.ZoneName }" (click)="getSliderItem('ctcZone',zone.ZoneName,zone.ZoneCode)" >{{zone.ZoneName}}</li>
                    </ul>
                    <input type="hidden" [ngModel]="ctcZoneDef" name="Sugg_Addr3">

                  </div>
                </div>

                <div class="col-md-12">
                  <input ngModel name="Sugg_Addr4" type="text" id="addr4" placeholder="請輸入地址">
                </div>
                </div>
              </div>

            </div>


            <div class="row form-group">
              <div class="col-md-3">
                <label for="email"><h4 class="form-title"><span class="font-color-red">*</span>E-Mail</h4></label>
              </div>
              <div class="col-md-9">
                <!-- 驗證回覆 Email -->
                <input #suggEmail="ngModel" ngModel name="Sugg_Email" type="text" id="email" placeholder="Email" required>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <label for="phone1" id="phone"><h4 class="form-title"><span class="font-color-red">*</span>聯絡方式</h4></label>
              </div>
              <div class="col-md-9">

                <input class="hidden-xs hidden-sm" ngModel name="Sugg_Telno" type="text" id="phone1" pattern="[0-9]\*" placeholder="電話 Ex:052254321">
                <input class="hidden-xs hidden-sm" ngModel name="Sugg_Mobile" type="text" id="mobile1" pattern="[0-9]\*" placeholder="行動電話 Ex: 0912345678">
                <input class="hidden-md hidden-lg" ngModel name="Sugg_Telno" type="tel" id="phone2" pattern="[0-9]\*" placeholder="電話 Ex:052254321">
                <input class="hidden-md hidden-lg" ngModel name="Sugg_Mobile" type="tel" id="mobile2" pattern="[0-9]\*" placeholder="行動電話 Ex: 0912345678">
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="my-0">身份</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio row id-list">
                  <li class="col-md-3 col-sm-4" *ngFor="let role of roles;let i =index">
                    <input [ngClass]="{'active':myForm.value.Sugg_TypeId == role.AppealerTypeId}" [ngModel]="roleDef" name="Sugg_TypeId" type="radio" [value]="role.AppealerTypeId" id="role{{i}}"> <label for="role{{i}}">{{role.AppealerTypeDesc}}</label>
                  </li>
                </ul>
              </div>
            </div>
            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="my-0">年齡區間</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio row id-list">
                  <li class="col-md-4 col-sm-5" *ngFor="let age of ageRange; let i = index">
                    <input [ngClass]="{'active':myForm.value.Sugg_AgeRng == age.Id}" [ngModel]="ageDef" name="Sugg_AgeRng" type="radio" [value]="age.Id" id="age{{i}}"> <label for="age{{i}}">{{age.Type}}</label>
                  </li>
                </ul>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="my-0">性別</h4>
              </div>
              <div class="col-md-9">
                <ul class="form-radio row id-list">
                  <li class="col-md-3 col-sm-4" *ngFor="let sex of sex;let i =index">
                    <input [ngClass]="{'active':myForm.value.Sugg_Sex == sex.Id}" [ngModel]="sexDef" name="Sugg_Sex" type="radio" [value]="sex.Id" id="sex{{i}}"> <label for="sex{{i}}">{{sex.Type}}</label>
                  </li>
                </ul>
              </div>
              <div class="col-md-1 hidden-xs">
                  <i class="fa "></i>
              </div>
            </div>

            <div class="row form-group">
              <div class="col-md-3">
                <h4 class="form-title">附加檔案</h4>
              </div>
              <div class="col-md-9">
                <div class="files" (click)="triggerFileBtn()">
                  <div class="file-upload fa">檔案上傳</div>
                </div>
                <input class="hidden" id="Files" multiple type="file" (change)="filesUpload($event.target)">
              </div>
              <div class="col-md-1 hidden-xs">
                  <i class="fa "></i>
              </div>
              <div class="col-md-10 col-md-offset-2">
                <ul>
                  <li class="file-tag clear-fix" *ngFor="let file of uploadFiles"><span>{{file.name}}</span> </li>
                </ul>
                <input [ngModel]="filesCount" name="Subj_FileCount" type="hidden">
                <input [ngModel]="filesName" name="Atth_FileNames" type="hidden">
                <input [ngModel]="caseToken" name="Case_Token" type="hidden">

              </div>
            </div>

            <div class="row pt-20">
              <div class="col-md-7 pb-20">
                <div class="row">
                  <div class="col-xs-7 col-sm-5">
                    <img class="v-img" src="{{recaptchaImg}}" alt="驗證碼" title="請輸入驗證碼"><br />
                    <div class="v-hit" (click)="getRecaptcha()">重新取得驗證碼？</div>
                  </div>
                  <div class="col-xs-5 col-sm-7">
                    <div class="field">
                      <label class="field-name">驗證碼</label>
                      <!-- 驗證驗證碼 -->
                      <input id="validationCode" #recapcha="ngModel" required ngModel name="Input_ValidationCode" class="field-entery" type="text" placeholder="">
                    </div>
                  </div>
                </div>
                <input [ngModel]="hashCode" name="Hash_Code" type="hidden">
                <input [ngModel]="timeStamp" name="Time_Stamp" type="hidden">
              </div>
              <div class="col-md-5 text-right">
                  <button type="button" class="btn btn-green" (click)="submitData(myForm);">填寫完成</button>
              </div>
            </div>



        </div>

        <div class="form-validation-msg" [ngClass]="{'invalid':validForm, 'valid':!validForm}" *ngIf="myForm.touched && validForm" (click)="goInvalidField()">
          <span *ngIf="!validForm">資料驗證完成！</span>
          <span *ngIf="validForm">
            資料尚未填寫完成！<wbr/>
            <em class="">{{validForm.msg}}</em>
          </span>
        </div>
        <div class="form-validation-msg" [ngClass]="{'invalid': sendErr}" *ngIf="sendErr" (click)="goInvalidField()">
          <span>
            資料尚未填寫完成！<wbr/>
            <em class="">{{sendErr}}</em>
          </span>
        </div>
      </form>
    </div>
  </div>

  <div class="line-box line-box-tiny mx-auto" *ngIf="completeMessg === true">
    <div>
      <header class="line-box-title deco-triangle">
        <h1>申報完成</h1>
        <p>Success</p>
      </header>
      <article class="info">
        <p class="info-content">
          我們已收到您對本府的反映案件，為確認您的信箱未遭冒用，我們即將寄出確認信至您所填寫的：kkk@kkk.com 信箱， 請您於收到該確認信後，點選「確認信件」連結，以便完成您的案件反映流程，我們在收到您的確認後，將由系統自動寄出案件編號至您的信箱並立即進行分案處理。 謝謝您！
        </p>
      </article>

        <a type="button" class="btn btn-green" routerLink="/">回到首頁</a>
    </div>
  </div>
</section>
<div class="pop" [ngClass]="{'active':showLoading}" >
  <div class="pop-content">
    <div class="mk-spinner-doublecircle"></div>
    <span class="loading-words">Sending ...</span>
  </div>
</div>
<div class="fack-loading">
  <div class="content"></div>
</div>
